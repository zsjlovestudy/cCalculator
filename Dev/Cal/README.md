# 科学计算器（科学计算组件）更新说明

## 版本更新：v0.0.1 → v0.0.2

### 主要变更

本次更新将科学计算器（科学计算组件）的数据输入/输出方式**从文件读写替换为TCP通信**，使其能够与系统中的中间组件通过TCP协议直接通信，符合系统架构设计要求。

### 详细变更内容

1. **TCP通信实现**
   - 新增创建TCP服务器监听65433端口
   - 实现数据接收协议（自定义结束标记`<END>`）
   - 添加数据分段接收功能（每块1024字节）
   - 支持结果数据的TCP发送

2. **文件操作移除**
   - 删除所有`formula.txt`读取操作
   - 删除所有`result.txt`写入操作
   - 删除文件内容清空逻辑

3. **数据流重构**
   - 输入数据来源：TCP连接（中间组件）而非文件
   - 输出目标：TCP连接（中间组件）而非文件

4. **错误处理增强**
   - 新增网络通信异常捕获
   - 保留原有计算错误处理机制
   - 添加客户端连接关闭处理

5. **日志功能改进**
   - 添加TCP服务器启动提示
   - 显示客户端连接信息
   - 记录计算结果发送状态

### 使用说明

1. **启动服务器**
   ```bash
   python scientific_calculator_c.py
   ```
   启动后将显示：
   ```
   科学计算 - 科学计算服务器已启动，等待连接...
   ```

2. **连接规范**
   - 监听端口：65433
   - 协议：TCP
   - 数据包格式：字符串 + `<END>`结束标记
   - 连接方式：持续连接（计算完成后自动关闭连接）

3. **数据处理流程**
   ```
   中间组件 → [公式字符串 + <END>] → 科学计算组件
   科学计算组件 → [计算结果 + <END>] → 中间组件
   ```

### 注意事项


1. **端口配置**
   - 默认使用65433端口
   - 修改方法：
   ```python
   server_address = ('0.0.0.0', 65433)  # 修改此处端口号
   ```

2. **性能考虑**
   - 当前为单线程顺序处理
   - 高并发场景下需添加线程池处理

### 兼容性说明

本版本需要与以下组件配合使用：
- 前端组件：负责发起计算请求
- 中间组件：负责格式规范化及数据中转
- 通信协议需包含`<END>`结束标记

---

